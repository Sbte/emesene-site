--- 
name: rough-guide-to-create-windows-packages
layout: post
title: rough guide to create windows packages
time: 2011-03-18 01:42:00 +01:00
---
here are some notes I made while making the last packages for windows.<br /><br />with this and using my repo you should have a fully working version (with some bugs, but those are from emesene and note because of the packaging)<br /><br />download the following files and install them in the order they appear<br /><br /><ul><li>python 2.6</li><ul><li><a href="http://www.python.org/ftp/python/2.6.6/python-2.6.6.msi">http://www.python.org/ftp/python/2.6.6/python-2.6.6.msi</a></li></ul><li>pygtk all in one</li><ul><li><a href="http://ftp.gnome.org/pub/GNOME/binaries/win32/pygtk/2.22/pygtk-all-in-one-2.22.6.win32-py2.6.msi">http://ftp.gnome.org/pub/GNOME/binaries/win32/pygtk/2.22/pygtk-all-in-one-2.22.6.win32-py2.6.msi</a></li></ul><li>vc++ 2008 redistributable</li><ul><li><a href="http://www.microsoft.com/downloads/details.aspx?familyid=9B2DA534-3E03-4391-8A4D-074B9F2BC1BF">http://www.microsoft.com/downloads/details.aspx?familyid=9B2DA534-3E03-4391-8A4D-074B9F2BC1BF</a></li></ul><li>openssl 1.0</li><ul><li><a href="http://www.slproweb.com/download/Win32OpenSSL-1_0_0d.exe">http://www.slproweb.com/download/Win32OpenSSL-1_0_0d.exe</a></li></ul><li>pyopenssl</li><ul><li><a href="http://launchpadlibrarian.net/58498596/pyOpenSSL-0.11.winxp32-py2.6.msi">http://launchpadlibrarian.net/58498596/pyOpenSSL-0.11.winxp32-py2.6.msi</a></li></ul><li>pycrypto</li><ul><li><a href="http://www.voidspace.org.uk/downloads/pycrypto-2.3.win32-py2.6.zip">http://www.voidspace.org.uk/downloads/pycrypto-2.3.win32-py2.6.zip</a></li></ul><li>pywin32</li><ul><li><a href="http://sourceforge.net/projects/pywin32/files/pywin32/Build%20214/pywin32-214.win32-py2.6.exe/download">http://sourceforge.net/projects/pywin32/files/pywin32/Build%20214/pywin32-214.win32-py2.6.exe/download</a></li></ul></ul><br />download the following two and follow the instructions below<br /><br /><ul><li>webkit</li><ul><li><a href="http://dl.dropbox.com/u/2554170/webkitgtk-1.2.7.7z">http://dl.dropbox.com/u/2554170/webkitgtk-1.2.7.7z</a></li></ul><li>pywebkit</li><ul><li><a href="http://dl.dropbox.com/u/2554170/pywebkitgtk-1.1.8.7z">http://dl.dropbox.com/u/2554170/pywebkitgtk-1.1.8.7z</a></li></ul></ul><br /><ul><li>download and install 7 zip</li><ul><li>&nbsp;<a href="http://garr.dl.sourceforge.net/project/sevenzip/7-Zip/9.20/7z920.msi">http://garr.dl.sourceforge.net/project/sevenzip/7-Zip/9.20/7z920.msi</a></li></ul></ul><br /><ul><li>extract the webkit file on:</li><ul><li>C:\Python26\Lib\site-packages\gtk-2.0\runtime\</li><li>if it asks for an override select "No"</li></ul><li>extract the pywebkit file on:</li><ul><li>C:\Python26\</li></ul></ul><br />install the following files<br /><br /><ul><li>py2exe</li><ul><li><a href="http://sourceforge.net/projects/py2exe/files/py2exe/0.6.9/py2exe-0.6.9.win32-py2.6.exe/download">http://sourceforge.net/projects/py2exe/files/py2exe/0.6.9/py2exe-0.6.9.win32-py2.6.exe/download</a></li></ul><li>nsis</li><ul><li><a href="http://sourceforge.net/projects/nsis/files/NSIS%202/2.46/nsis-2.46-setup.exe/download">http://sourceforge.net/projects/nsis/files/NSIS%202/2.46/nsis-2.46-setup.exe/download</a></li></ul><li>msysgit</li><ul><li><a href="http://code.google.com/p/msysgit/downloads/detail?name=Git-1.7.4-preview20110204.exe&amp;can=2&amp;q=">http://code.google.com/p/msysgit/downloads/detail?name=Git-1.7.4-preview20110204.exe&amp;can=2&amp;q=</a></li></ul></ul><br />open the git shell and do <br /><br /><pre>git clone https://github.com/emesene/emesene.git<br />cd emesene<br />git submodule init<br />git submodule update<br /><br />cd emesene<br />cp ../dlls/* .<br /><br />cp -r e3/papylib/papyon/papyon/ .&nbsp;</pre><pre>cp -r e3/jabber/xmppy/xmpp/ .</pre><br /><br />set the python path (rigth click on "My Computer", click on properties, go to<br />the advanced tab, click the "Environment Variables" button, on the "System<br />variables" section select the "Path" variable and click edit, on the "Variable<br />value" dield go to the end and add ";C:\Python26" without the quotes and click<br />ok to close all the dialogs. Open a new shell and go to the directory where you<br />where before and do<br /><br /><pre>python emesene.py<br /></pre><br />creating the installer<br /><br />first you need to override the boot_common.py file from py2exe to avoid displaying an annoying dialog at exit.<br /><br />to do this you have to copy the file in windows/boot_common.py on the emesene repository to the py2exe directory, in my case in the command line (using the git command line that has come cool unix tools) is:<br /><br />you only need to do this once.<br /><br /><pre>cp ../windows/boot_common.py /c/Python26/Lib/site-packages/py2exe/<br /></pre><br />and then<br /><br /><pre>cp ../setup.py ../ez_setup.py ../emesene.ico .<br />python setup.py py2exe<br />cp *.dll ../dist/<br />cd ../dist/<br /></pre><br />copy "etc" "lib" and "share" from C:\Python26\Lib\site-packages\gtk-2.0\runtime<br />to emesene/dist<br /><br />on the git shell it would be <br /><br /><pre>cp -r /c/Python26/Lib/site-packages/gtk-2.0/runtime/etc/ .<br />cp -r /c/Python26/Lib/site-packages/gtk-2.0/runtime/lib/ .<br />cp -r /c/Python26/Lib/site-packages/gtk-2.0/runtime/share/ .<br /></pre><br />then remove some unused files to make the installers smaller<br /><br /><pre>cd share/<br />rm -rf aclocal/ dtds/ doc/ icon-naming-utils/ locale/* gtk-doc icons/Tango/scalable/<br />cd themes/<br />rm -rf Default/ Emacs/ Raleigh/<br />cd ../..<br /></pre><br />you can still remove more files (like unused icons)<br /><br />now right click on the .nsi files on emesene/ and select "Compile NSIS Script"<br /><br />they will create the installer and the protable versions for you<br /><br />and that's all<div class="blogger-post-footer"><script type="text/javascript"><!--
google_ad_client = "pub-7085255688477101";
/* 336x280, creado 19/04/09 */
google_ad_slot = "4169844387";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/28704147-3070426400956185448?l=blog.emesene.org' alt='' /></div>
